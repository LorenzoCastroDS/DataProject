{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "f81f4d50",
   "metadata": {},
   "source": [
    "Los datos con los que vamos a trabajar estan ya descargados y se encuentran en dos archivos csv separados (train y test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "73ace636",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "a4f9309e",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Job</th>\n",
       "      <th>Marital</th>\n",
       "      <th>Education</th>\n",
       "      <th>Default</th>\n",
       "      <th>Balance</th>\n",
       "      <th>HHInsurance</th>\n",
       "      <th>CarLoan</th>\n",
       "      <th>Communication</th>\n",
       "      <th>LastContactDay</th>\n",
       "      <th>LastContactMonth</th>\n",
       "      <th>NoOfContacts</th>\n",
       "      <th>DaysPassed</th>\n",
       "      <th>PrevAttempts</th>\n",
       "      <th>Outcome</th>\n",
       "      <th>CallStart</th>\n",
       "      <th>CallEnd</th>\n",
       "      <th>CarInsurance</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>32</td>\n",
       "      <td>management</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>1218</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>telephone</td>\n",
       "      <td>28</td>\n",
       "      <td>jan</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>13:45:20</td>\n",
       "      <td>13:46:30</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>32</td>\n",
       "      <td>blue-collar</td>\n",
       "      <td>married</td>\n",
       "      <td>primary</td>\n",
       "      <td>0</td>\n",
       "      <td>1156</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>26</td>\n",
       "      <td>may</td>\n",
       "      <td>5</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14:49:03</td>\n",
       "      <td>14:52:08</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>29</td>\n",
       "      <td>management</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>637</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>3</td>\n",
       "      <td>jun</td>\n",
       "      <td>1</td>\n",
       "      <td>119</td>\n",
       "      <td>1</td>\n",
       "      <td>failure</td>\n",
       "      <td>16:30:24</td>\n",
       "      <td>16:36:04</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>25</td>\n",
       "      <td>student</td>\n",
       "      <td>single</td>\n",
       "      <td>primary</td>\n",
       "      <td>0</td>\n",
       "      <td>373</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>11</td>\n",
       "      <td>may</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12:06:43</td>\n",
       "      <td>12:20:22</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>30</td>\n",
       "      <td>management</td>\n",
       "      <td>married</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>2694</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>3</td>\n",
       "      <td>jun</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14:35:44</td>\n",
       "      <td>14:38:56</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>32</td>\n",
       "      <td>technician</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>1625</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>22</td>\n",
       "      <td>may</td>\n",
       "      <td>1</td>\n",
       "      <td>109</td>\n",
       "      <td>1</td>\n",
       "      <td>failure</td>\n",
       "      <td>14:58:08</td>\n",
       "      <td>15:11:24</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>37</td>\n",
       "      <td>admin.</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>1000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>17</td>\n",
       "      <td>mar</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>13:00:02</td>\n",
       "      <td>13:03:17</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>35</td>\n",
       "      <td>management</td>\n",
       "      <td>divorced</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>538</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12</td>\n",
       "      <td>may</td>\n",
       "      <td>4</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15:39:43</td>\n",
       "      <td>15:40:49</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>30</td>\n",
       "      <td>admin.</td>\n",
       "      <td>married</td>\n",
       "      <td>secondary</td>\n",
       "      <td>0</td>\n",
       "      <td>187</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>18</td>\n",
       "      <td>nov</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12:20:56</td>\n",
       "      <td>12:22:42</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>30</td>\n",
       "      <td>blue-collar</td>\n",
       "      <td>married</td>\n",
       "      <td>secondary</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>cellular</td>\n",
       "      <td>12</td>\n",
       "      <td>may</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>09:22:20</td>\n",
       "      <td>09:27:46</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Age          Job   Marital  Education  Default  Balance  HHInsurance  \\\n",
       "Id                                                                         \n",
       "1    32   management    single   tertiary        0     1218            1   \n",
       "2    32  blue-collar   married    primary        0     1156            1   \n",
       "3    29   management    single   tertiary        0      637            1   \n",
       "4    25      student    single    primary        0      373            1   \n",
       "5    30   management   married   tertiary        0     2694            0   \n",
       "6    32   technician    single   tertiary        0     1625            0   \n",
       "7    37       admin.    single   tertiary        0     1000            1   \n",
       "8    35   management  divorced   tertiary        0      538            1   \n",
       "9    30       admin.   married  secondary        0      187            1   \n",
       "10   30  blue-collar   married  secondary        0        3            1   \n",
       "\n",
       "    CarLoan Communication  LastContactDay LastContactMonth  NoOfContacts  \\\n",
       "Id                                                                         \n",
       "1         0     telephone              28              jan             2   \n",
       "2         0           NaN              26              may             5   \n",
       "3         0      cellular               3              jun             1   \n",
       "4         0      cellular              11              may             2   \n",
       "5         0      cellular               3              jun             1   \n",
       "6         0      cellular              22              may             1   \n",
       "7         0      cellular              17              mar             1   \n",
       "8         0           NaN              12              may             4   \n",
       "9         0      cellular              18              nov             1   \n",
       "10        1      cellular              12              may             2   \n",
       "\n",
       "    DaysPassed  PrevAttempts  Outcome CallStart   CallEnd  CarInsurance  \n",
       "Id                                                                       \n",
       "1           -1             0      NaN  13:45:20  13:46:30             0  \n",
       "2           -1             0      NaN  14:49:03  14:52:08             0  \n",
       "3          119             1  failure  16:30:24  16:36:04             1  \n",
       "4           -1             0      NaN  12:06:43  12:20:22             1  \n",
       "5           -1             0      NaN  14:35:44  14:38:56             0  \n",
       "6          109             1  failure  14:58:08  15:11:24             1  \n",
       "7           -1             0      NaN  13:00:02  13:03:17             1  \n",
       "8           -1             0      NaN  15:39:43  15:40:49             0  \n",
       "9           -1             0      NaN  12:20:56  12:22:42             0  \n",
       "10          -1             0      NaN  09:22:20  09:27:46             0  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "car_train = pd.read_csv(\"/home/dsc/Downloads/carInsurance_train.csv\", index_col=0)\n",
    "car_train.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f175e56c",
   "metadata": {},
   "source": [
    "Aqui nos fijamos en que la columna \"Outcome\" tiene muchos NaN, la estudiamos mas de cerca a ver si realmente merece la pena tenerla"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c83ea150",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3042"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "car_train[\"Outcome\"].isna().sum()\n",
    "# Nos encontramos con que hay 3042 NaN de 4000 valores, luego esta columna nos la vamos a fumar"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ed746da4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "902"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "car_train[\"Communication\"].isna().sum() #  a ti te perdonamos"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "244a0b5e",
   "metadata": {},
   "source": [
    "Nuevo dataset inicial"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "9b623b6f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Job</th>\n",
       "      <th>Marital</th>\n",
       "      <th>Education</th>\n",
       "      <th>Default</th>\n",
       "      <th>Balance</th>\n",
       "      <th>HHInsurance</th>\n",
       "      <th>CarLoan</th>\n",
       "      <th>Communication</th>\n",
       "      <th>LastContactDay</th>\n",
       "      <th>LastContactMonth</th>\n",
       "      <th>NoOfContacts</th>\n",
       "      <th>DaysPassed</th>\n",
       "      <th>PrevAttempts</th>\n",
       "      <th>CallStart</th>\n",
       "      <th>CallEnd</th>\n",
       "      <th>CarInsurance</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>32</td>\n",
       "      <td>management</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>1218</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>telephone</td>\n",
       "      <td>28</td>\n",
       "      <td>jan</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>13:45:20</td>\n",
       "      <td>13:46:30</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>32</td>\n",
       "      <td>blue-collar</td>\n",
       "      <td>married</td>\n",
       "      <td>primary</td>\n",
       "      <td>0</td>\n",
       "      <td>1156</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>26</td>\n",
       "      <td>may</td>\n",
       "      <td>5</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>14:49:03</td>\n",
       "      <td>14:52:08</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>29</td>\n",
       "      <td>management</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>637</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>3</td>\n",
       "      <td>jun</td>\n",
       "      <td>1</td>\n",
       "      <td>119</td>\n",
       "      <td>1</td>\n",
       "      <td>16:30:24</td>\n",
       "      <td>16:36:04</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>25</td>\n",
       "      <td>student</td>\n",
       "      <td>single</td>\n",
       "      <td>primary</td>\n",
       "      <td>0</td>\n",
       "      <td>373</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>11</td>\n",
       "      <td>may</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>12:06:43</td>\n",
       "      <td>12:20:22</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>30</td>\n",
       "      <td>management</td>\n",
       "      <td>married</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>2694</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>3</td>\n",
       "      <td>jun</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>14:35:44</td>\n",
       "      <td>14:38:56</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>32</td>\n",
       "      <td>technician</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>1625</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>22</td>\n",
       "      <td>may</td>\n",
       "      <td>1</td>\n",
       "      <td>109</td>\n",
       "      <td>1</td>\n",
       "      <td>14:58:08</td>\n",
       "      <td>15:11:24</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>37</td>\n",
       "      <td>admin.</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>1000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>17</td>\n",
       "      <td>mar</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>13:00:02</td>\n",
       "      <td>13:03:17</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>35</td>\n",
       "      <td>management</td>\n",
       "      <td>divorced</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>538</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12</td>\n",
       "      <td>may</td>\n",
       "      <td>4</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>15:39:43</td>\n",
       "      <td>15:40:49</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>30</td>\n",
       "      <td>admin.</td>\n",
       "      <td>married</td>\n",
       "      <td>secondary</td>\n",
       "      <td>0</td>\n",
       "      <td>187</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>18</td>\n",
       "      <td>nov</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>12:20:56</td>\n",
       "      <td>12:22:42</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>30</td>\n",
       "      <td>blue-collar</td>\n",
       "      <td>married</td>\n",
       "      <td>secondary</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>cellular</td>\n",
       "      <td>12</td>\n",
       "      <td>may</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>09:22:20</td>\n",
       "      <td>09:27:46</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Age          Job   Marital  Education  Default  Balance  HHInsurance  \\\n",
       "Id                                                                         \n",
       "1    32   management    single   tertiary        0     1218            1   \n",
       "2    32  blue-collar   married    primary        0     1156            1   \n",
       "3    29   management    single   tertiary        0      637            1   \n",
       "4    25      student    single    primary        0      373            1   \n",
       "5    30   management   married   tertiary        0     2694            0   \n",
       "6    32   technician    single   tertiary        0     1625            0   \n",
       "7    37       admin.    single   tertiary        0     1000            1   \n",
       "8    35   management  divorced   tertiary        0      538            1   \n",
       "9    30       admin.   married  secondary        0      187            1   \n",
       "10   30  blue-collar   married  secondary        0        3            1   \n",
       "\n",
       "    CarLoan Communication  LastContactDay LastContactMonth  NoOfContacts  \\\n",
       "Id                                                                         \n",
       "1         0     telephone              28              jan             2   \n",
       "2         0           NaN              26              may             5   \n",
       "3         0      cellular               3              jun             1   \n",
       "4         0      cellular              11              may             2   \n",
       "5         0      cellular               3              jun             1   \n",
       "6         0      cellular              22              may             1   \n",
       "7         0      cellular              17              mar             1   \n",
       "8         0           NaN              12              may             4   \n",
       "9         0      cellular              18              nov             1   \n",
       "10        1      cellular              12              may             2   \n",
       "\n",
       "    DaysPassed  PrevAttempts CallStart   CallEnd  CarInsurance  \n",
       "Id                                                              \n",
       "1           -1             0  13:45:20  13:46:30             0  \n",
       "2           -1             0  14:49:03  14:52:08             0  \n",
       "3          119             1  16:30:24  16:36:04             1  \n",
       "4           -1             0  12:06:43  12:20:22             1  \n",
       "5           -1             0  14:35:44  14:38:56             0  \n",
       "6          109             1  14:58:08  15:11:24             1  \n",
       "7           -1             0  13:00:02  13:03:17             1  \n",
       "8           -1             0  15:39:43  15:40:49             0  \n",
       "9           -1             0  12:20:56  12:22:42             0  \n",
       "10          -1             0  09:22:20  09:27:46             0  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "car_train = pd.read_csv(\"/home/dsc/Downloads/carInsurance_train.csv\", index_col=0).drop(\"Outcome\", axis=1)\n",
    "car_train.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "f6460c3e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(2961, 17)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "car_train = car_train.dropna()\n",
    "car_train.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f0bcd65f",
   "metadata": {},
   "source": [
    "Vamos a chequear fráficamente la relación entre las variables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a42a6907",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "import seaborn as sns\n",
    "#sns.pairplot(car_train)\n",
    "# me quedo iguá"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "8e6d0818",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-1      2054\n",
       " 92       33\n",
       " 182      31\n",
       " 91       22\n",
       " 183      21\n",
       "        ... \n",
       " 854       1\n",
       " 13        1\n",
       " 15        1\n",
       " 21        1\n",
       " 769       1\n",
       "Name: DaysPassed, Length: 317, dtype: int64"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "car_train[\"DaysPassed\"].value_counts() # dias desde la ultima llamada"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "01f1b1bb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0     2054\n",
       "1      318\n",
       "2      234\n",
       "3      122\n",
       "4       77\n",
       "5       57\n",
       "6       24\n",
       "7       18\n",
       "8       17\n",
       "10      10\n",
       "9        7\n",
       "14       5\n",
       "19       4\n",
       "13       4\n",
       "11       3\n",
       "12       3\n",
       "58       1\n",
       "30       1\n",
       "18       1\n",
       "23       1\n",
       "Name: PrevAttempts, dtype: int64"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "car_train[\"PrevAttempts\"].value_counts() # intentos fallidos hasta llamada"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "01cbd506",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='DaysPassed', ylabel='PrevAttempts'>"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAl4AAAGpCAYAAABcXji6AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAABT9ElEQVR4nO3deZQc93ne++9bVb1N9yxYBiB2kABILZREiRBtWY7kiJIjLzF9o9iys1G5TqScKIpkJzeWnXtPbs69OVZyE0e2wiyKHYt2HEeK5ISKY1u2qDi2FosCJEqiRIoASQDEQmAADGbpvap+94+qbvQMZukBuntmGs/nHJyZXqrqV1U9My+q6qnXnHOIiIiISP956z0AERERkduFCi8RERGRAVHhJSIiIjIgKrxEREREBkSFl4iIiMiABOs9gG5s377dHTx4cL2HISIiIrKq48ePX3bOTS712qYovA4ePMixY8fWexgiIiIiqzKz08u9plONIiIiIgPS18LLzCbM7JNm9oyZPW1mbzCzrWb2h2Z2Iv26pZ9jEBEREdko+n3E65eA33fOvQx4DfA08EHgcefcEeDx9LGIiIjI0Otb4WVmY8CbgF8FcM41nHPXgIeAR9O3PQr8aL/GICIiIrKR9POI113AFPBrZvY1M/sVMysCO51zFwDSrzuWmtjM3m1mx8zs2NTUVB+HKSIiIjIY/Sy8AuB1wL9xzr0WKLOG04rOuY865446545OTi6ZyBQRERHZVPpZeJ0Fzjrnvpw+/iRJIXbRzHYBpF8v9XEMIiIiIhtG3wov59xLwItmdk/61IPAt4FPAw+nzz0MPNavMYiIiIhsJP2+ger7gN80syzwPPDXSYq9T5jZTwFngB/r8xhERERENoS+Fl7OuSeBo0u89GA/lysiIiKyEenO9SIiIiIDosJLREREZEBUeImIiIgMiAovEemJWjPiynydWjNa76GIiGxY/U41isht4NTleR578jzNKCbjezx0324Obi+t97BERDYcHfESkVtSa0Y89uR5irmA3RMjFHMBjz15Xke+RESWoMJLRG5JuR7SjGJGsskB9JFsQDOKKdfDdR6ZiMjGo8JLRG5JMReQ8T0qjaTQqjRCMr5HMacrGUREFlPhJSK3JJ/xeei+3ZTrIeevVSjXQx66bzf5jL/eQxMR2XD0X1IRuWUHt5d4z5sPUa6HFHOBii4RkWWo8BKRnshnfBVcIiKr0KlGERERkQFR4SUiIiIyICq8RERERAZEhZeIiIjIgKjwEhERERkQFV4iIiIiA6LCS0RERGRAVHiJiIiIDIgKLxEREZEBUeElIiIiMiAqvEREREQGRIWXiIiIyICo8BIREREZEBVeIiIiIgOiwktERERkQFR4iYiIiAyICi8RERGRAVHhJSIiIjIgKrxEREREBkSFl4iIiMiAqPASERERGRAVXiIiIiIDosJLREREZEBUeImIiIgMiAovERERkQFR4SUiIiIyICq8RERERAZEhZeIiIjIgKjwEhERERkQFV4iIiIiA6LCS0RERGRAVHiJiIiIDIgKLxEREZEBUeElIiIiMiAqvEREREQGRIWXiIiIyICo8BIREREZEBVeIiIiIgOiwktERERkQIJ+ztzMTgFzQASEzrmjZrYV+DhwEDgF/Lhzbrqf4xARERHZCAZxxOvPOufuc84dTR9/EHjcOXcEeDx9LCIiIjL01uNU40PAo+n3jwI/ug5jEBERERm4fhdeDvgDMztuZu9On9vpnLsAkH7dsdSEZvZuMztmZsempqb6PEwRERGR/uvrNV7AG51z581sB/CHZvZMtxM65z4KfBTg6NGjrl8DFBERERmUvh7xcs6dT79eAv4r8ABw0cx2AaRfL/VzDCIiIiIbRd8KLzMrmtlo63vg+4GngE8DD6dvexh4rF9jEBEREdlI+nmqcSfwX82stZz/5Jz7fTP7CvAJM/sp4AzwY30cg4iIiMiG0bfCyzn3PPCaJZ6/AjzYr+WKiIiIbFS6c72IiIjIgKjwEhERERkQFV4iIiIiA6LCS0RERGRAVHiJiIiIDIgKLxEREZEBUeElIiIiMiAqvEREREQGRIWXiIiIyICo8BIREREZEBVeIiIiIgOiwktERERkQFR4iYiIiAyICi8RERGRAVHhJSIiIjIgKrxEREREBkSFl4iIiMiAqPASERERGRAVXiIiIiIDosJLREREZEBUeImIiIgMiAovERERkQFR4SUiIiIyICq8RERERAZEhZeIiIjIgKjwEhERERkQFV4iIiIiA6LCS0RERGRAVHiJiIiIDIgKLxEREZEBUeElIiIiMiAqvEREREQGRIWXiIiIyICo8BIREREZEBVeIiIiIgOiwktERERkQFR4iYiIiAyICi8RERGRAVHh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\n",
      "text/plain": [
       "<Figure size 720x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# vamos a plotear la relacion entre days passed y previous attemps a ver si hay correlacion\n",
    "car_train.plot(kind = \"scatter\",figsize=(10,7),\n",
    "x= \"DaysPassed\",\n",
    "y=\"PrevAttempts\",\n",
    "alpha=0.4, cmap=\"jet\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5eb8b960",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "18abdce4",
   "metadata": {},
   "source": [
    "Este segundo dataset lo hemos descargado y vemos que la ultima columna, \"y\" no tiene valores, luego este seria el dataset de validacion"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "78cb4aba",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Job</th>\n",
       "      <th>Marital</th>\n",
       "      <th>Education</th>\n",
       "      <th>Default</th>\n",
       "      <th>Balance</th>\n",
       "      <th>HHInsurance</th>\n",
       "      <th>CarLoan</th>\n",
       "      <th>Communication</th>\n",
       "      <th>LastContactDay</th>\n",
       "      <th>LastContactMonth</th>\n",
       "      <th>NoOfContacts</th>\n",
       "      <th>DaysPassed</th>\n",
       "      <th>PrevAttempts</th>\n",
       "      <th>CallStart</th>\n",
       "      <th>CallEnd</th>\n",
       "      <th>CarInsurance</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4001</th>\n",
       "      <td>25</td>\n",
       "      <td>admin.</td>\n",
       "      <td>single</td>\n",
       "      <td>secondary</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12</td>\n",
       "      <td>may</td>\n",
       "      <td>12</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>17:17:42</td>\n",
       "      <td>17:18:06</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4002</th>\n",
       "      <td>40</td>\n",
       "      <td>management</td>\n",
       "      <td>married</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>cellular</td>\n",
       "      <td>24</td>\n",
       "      <td>jul</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>09:13:44</td>\n",
       "      <td>09:14:37</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4003</th>\n",
       "      <td>44</td>\n",
       "      <td>management</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>-1313</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>cellular</td>\n",
       "      <td>15</td>\n",
       "      <td>may</td>\n",
       "      <td>10</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>15:24:07</td>\n",
       "      <td>15:25:51</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4004</th>\n",
       "      <td>27</td>\n",
       "      <td>services</td>\n",
       "      <td>single</td>\n",
       "      <td>secondary</td>\n",
       "      <td>0</td>\n",
       "      <td>6279</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>9</td>\n",
       "      <td>nov</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>09:43:44</td>\n",
       "      <td>09:48:01</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4005</th>\n",
       "      <td>53</td>\n",
       "      <td>technician</td>\n",
       "      <td>married</td>\n",
       "      <td>secondary</td>\n",
       "      <td>0</td>\n",
       "      <td>7984</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>2</td>\n",
       "      <td>feb</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>16:31:51</td>\n",
       "      <td>16:34:22</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4006</th>\n",
       "      <td>28</td>\n",
       "      <td>management</td>\n",
       "      <td>single</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>12956</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>2</td>\n",
       "      <td>jul</td>\n",
       "      <td>1</td>\n",
       "      <td>399</td>\n",
       "      <td>3</td>\n",
       "      <td>10:14:11</td>\n",
       "      <td>10:29:51</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4007</th>\n",
       "      <td>39</td>\n",
       "      <td>blue-collar</td>\n",
       "      <td>married</td>\n",
       "      <td>secondary</td>\n",
       "      <td>0</td>\n",
       "      <td>1044</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>2</td>\n",
       "      <td>feb</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>11:30:35</td>\n",
       "      <td>11:33:13</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4008</th>\n",
       "      <td>50</td>\n",
       "      <td>management</td>\n",
       "      <td>married</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>414</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>3</td>\n",
       "      <td>apr</td>\n",
       "      <td>1</td>\n",
       "      <td>302</td>\n",
       "      <td>3</td>\n",
       "      <td>09:06:17</td>\n",
       "      <td>09:18:04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4009</th>\n",
       "      <td>56</td>\n",
       "      <td>management</td>\n",
       "      <td>divorced</td>\n",
       "      <td>tertiary</td>\n",
       "      <td>0</td>\n",
       "      <td>408</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>27</td>\n",
       "      <td>may</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>16:26:09</td>\n",
       "      <td>16:30:43</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4010</th>\n",
       "      <td>36</td>\n",
       "      <td>self-employed</td>\n",
       "      <td>married</td>\n",
       "      <td>secondary</td>\n",
       "      <td>0</td>\n",
       "      <td>1006</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>cellular</td>\n",
       "      <td>21</td>\n",
       "      <td>nov</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>13:51:12</td>\n",
       "      <td>13:52:41</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Age            Job   Marital  Education  Default  Balance  HHInsurance  \\\n",
       "Id                                                                             \n",
       "4001   25         admin.    single  secondary        0        1            1   \n",
       "4002   40     management   married   tertiary        0        0            1   \n",
       "4003   44     management    single   tertiary        0    -1313            1   \n",
       "4004   27       services    single  secondary        0     6279            1   \n",
       "4005   53     technician   married  secondary        0     7984            1   \n",
       "4006   28     management    single   tertiary        0    12956            1   \n",
       "4007   39    blue-collar   married  secondary        0     1044            1   \n",
       "4008   50     management   married   tertiary        0      414            1   \n",
       "4009   56     management  divorced   tertiary        0      408            1   \n",
       "4010   36  self-employed   married  secondary        0     1006            1   \n",
       "\n",
       "      CarLoan Communication  LastContactDay LastContactMonth  NoOfContacts  \\\n",
       "Id                                                                           \n",
       "4001        1           NaN              12              may            12   \n",
       "4002        1      cellular              24              jul             1   \n",
       "4003        1      cellular              15              may            10   \n",
       "4004        0      cellular               9              nov             1   \n",
       "4005        0      cellular               2              feb             1   \n",
       "4006        0      cellular               2              jul             1   \n",
       "4007        0      cellular               2              feb             1   \n",
       "4008        0      cellular               3              apr             1   \n",
       "4009        0           NaN              27              may             1   \n",
       "4010        0      cellular              21              nov             2   \n",
       "\n",
       "      DaysPassed  PrevAttempts CallStart   CallEnd  CarInsurance  \n",
       "Id                                                                \n",
       "4001          -1             0  17:17:42  17:18:06           NaN  \n",
       "4002          -1             0  09:13:44  09:14:37           NaN  \n",
       "4003          -1             0  15:24:07  15:25:51           NaN  \n",
       "4004          -1             0  09:43:44  09:48:01           NaN  \n",
       "4005          -1             0  16:31:51  16:34:22           NaN  \n",
       "4006         399             3  10:14:11  10:29:51           NaN  \n",
       "4007          -1             0  11:30:35  11:33:13           NaN  \n",
       "4008         302             3  09:06:17  09:18:04           NaN  \n",
       "4009          -1             0  16:26:09  16:30:43           NaN  \n",
       "4010          -1             0  13:51:12  13:52:41           NaN  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "car_val = pd.read_csv(\"/home/dsc/Downloads/carInsurance_test.csv\", index_col=0).drop(\"Outcome\", axis=1)\n",
    "car_val.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "fd4c4533",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1000, 17)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "car_val.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "294924d1",
   "metadata": {},
   "source": [
    "Tenemos dos datasets, train con 4000 casos y test con 1000"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1c767074",
   "metadata": {},
   "source": [
    "### Objetivo: \n",
    "Predecir cuándo el cliente llamará o no en funcion de sus datos"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d60f6175",
   "metadata": {},
   "source": [
    "Como hemos dicho, la variable target será \"CarInsurance\" que nos dirá si finalmente llama o no, luego el dataset TRAIN se compondrá del resto de variables menos esa, mientras que el TEST será esa columna"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "c324af3c",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "X = car_train[car_train.columns[:-1]].select_dtypes(\"number\") # nos vamos a quedar de momento solo con las numericas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a9b2dc93",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Default</th>\n",
       "      <th>Balance</th>\n",
       "      <th>HHInsurance</th>\n",
       "      <th>CarLoan</th>\n",
       "      <th>LastContactDay</th>\n",
       "      <th>NoOfContacts</th>\n",
       "      <th>DaysPassed</th>\n",
       "      <th>PrevAttempts</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>32</td>\n",
       "      <td>0</td>\n",
       "      <td>1218</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>28</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>29</td>\n",
       "      <td>0</td>\n",
       "      <td>637</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>119</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>373</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>30</td>\n",
       "      <td>0</td>\n",
       "      <td>2694</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>32</td>\n",
       "      <td>0</td>\n",
       "      <td>1625</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>1</td>\n",
       "      <td>109</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3994</th>\n",
       "      <td>42</td>\n",
       "      <td>0</td>\n",
       "      <td>417</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>21</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3996</th>\n",
       "      <td>28</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>25</td>\n",
       "      <td>1</td>\n",
       "      <td>40</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3997</th>\n",
       "      <td>49</td>\n",
       "      <td>0</td>\n",
       "      <td>124</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>29</td>\n",
       "      <td>19</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3998</th>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>-400</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3999</th>\n",
       "      <td>36</td>\n",
       "      <td>0</td>\n",
       "      <td>658</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>29</td>\n",
       "      <td>1</td>\n",
       "      <td>227</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2961 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Age  Default  Balance  HHInsurance  CarLoan  LastContactDay  \\\n",
       "Id                                                                  \n",
       "1      32        0     1218            1        0              28   \n",
       "3      29        0      637            1        0               3   \n",
       "4      25        0      373            1        0              11   \n",
       "5      30        0     2694            0        0               3   \n",
       "6      32        0     1625            0        0              22   \n",
       "...   ...      ...      ...          ...      ...             ...   \n",
       "3994   42        0      417            0        0              21   \n",
       "3996   28        0        0            1        0              25   \n",
       "3997   49        0      124            1        1              29   \n",
       "3998   27        0     -400            0        1               8   \n",
       "3999   36        0      658            1        0              29   \n",
       "\n",
       "      NoOfContacts  DaysPassed  PrevAttempts  \n",
       "Id                                            \n",
       "1                2          -1             0  \n",
       "3                1         119             1  \n",
       "4                2          -1             0  \n",
       "5                1          -1             0  \n",
       "6                1         109             1  \n",
       "...            ...         ...           ...  \n",
       "3994             1          -1             0  \n",
       "3996             1          40             2  \n",
       "3997            19          -1             0  \n",
       "3998             1          -1             0  \n",
       "3999             1         227             3  \n",
       "\n",
       "[2961 rows x 9 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "338e0549",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CarInsurance</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Id</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3994</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3996</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3997</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3998</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3999</th>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2961 rows × 1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      CarInsurance\n",
       "Id                \n",
       "1                0\n",
       "3                1\n",
       "4                1\n",
       "5                0\n",
       "6                1\n",
       "...            ...\n",
       "3994             0\n",
       "3996             1\n",
       "3997             0\n",
       "3998             0\n",
       "3999             0\n",
       "\n",
       "[2961 rows x 1 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y = car_train[car_train.columns[-1:]]\n",
    "y"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "090deec5",
   "metadata": {},
   "source": [
    "Hacemos aqui por tanto la particion entre Train y test del primer dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "80fb4e62",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bb354b11",
   "metadata": {},
   "source": [
    "MVP: vamos a por un primer intento de predicción del algoritmo"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "98a379bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.metrics import f1_score"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "8cdc0003",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-16-cbb6cc7148f3>:2: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().\n",
      "  rf.fit(X_train, y_train)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0.6021840873634945"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rf = RandomForestClassifier()\n",
    "rf.fit(X_train, y_train)\n",
    "preds = rf.predict(X_test)\n",
    "f1_score(y_test, preds)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7bdf24b1",
   "metadata": {},
   "source": [
    "Hasta aqui se ha hecho la minima expresion. El pretratamiento mas simple posible. \n",
    "\n",
    "- 1. Obtencion de datos\n",
    "- 2. Tratamiento minimo de datos\n",
    "- 3. Particion del dataset para alimentar el modelo\n",
    "- 4. Elección del modelo y entrenamiento\n",
    "- 5. Calculo inicial del score\n",
    "\n",
    "Lo que vendrá ahora serán refinamientos y modificaciones de nuestro modelo que permitirán ajustar parámetros y mejorar nuestras predicciones para aumentar el score"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "0dc9b553",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Default</th>\n",
       "      <th>Balance</th>\n",
       "      <th>HHInsurance</th>\n",
       "      <th>CarLoan</th>\n",
       "      <th>LastContactDay</th>\n",
       "      <th>NoOfContacts</th>\n",
       "      <th>DaysPassed</th>\n",
       "      <th>PrevAttempts</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>32</td>\n",
       "      <td>0</td>\n",
       "      <td>1218</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>28</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>29</td>\n",
       "      <td>0</td>\n",
       "      <td>637</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>119</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>25</td>\n",
       "      <td>0</td>\n",
       "      <td>373</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>30</td>\n",
       "      <td>0</td>\n",
       "      <td>2694</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>32</td>\n",
       "      <td>0</td>\n",
       "      <td>1625</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>1</td>\n",
       "      <td>109</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3994</th>\n",
       "      <td>42</td>\n",
       "      <td>0</td>\n",
       "      <td>417</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>21</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3996</th>\n",
       "      <td>28</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>25</td>\n",
       "      <td>1</td>\n",
       "      <td>40</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3997</th>\n",
       "      <td>49</td>\n",
       "      <td>0</td>\n",
       "      <td>124</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>29</td>\n",
       "      <td>19</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3998</th>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>-400</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3999</th>\n",
       "      <td>36</td>\n",
       "      <td>0</td>\n",
       "      <td>658</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>29</td>\n",
       "      <td>1</td>\n",
       "      <td>227</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2961 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Age  Default  Balance  HHInsurance  CarLoan  LastContactDay  \\\n",
       "Id                                                                  \n",
       "1      32        0     1218            1        0              28   \n",
       "3      29        0      637            1        0               3   \n",
       "4      25        0      373            1        0              11   \n",
       "5      30        0     2694            0        0               3   \n",
       "6      32        0     1625            0        0              22   \n",
       "...   ...      ...      ...          ...      ...             ...   \n",
       "3994   42        0      417            0        0              21   \n",
       "3996   28        0        0            1        0              25   \n",
       "3997   49        0      124            1        1              29   \n",
       "3998   27        0     -400            0        1               8   \n",
       "3999   36        0      658            1        0              29   \n",
       "\n",
       "      NoOfContacts  DaysPassed  PrevAttempts  y  \n",
       "Id                                               \n",
       "1                2          -1             0  0  \n",
       "3                1         119             1  1  \n",
       "4                2          -1             0  1  \n",
       "5                1          -1             0  0  \n",
       "6                1         109             1  1  \n",
       "...            ...         ...           ... ..  \n",
       "3994             1          -1             0  0  \n",
       "3996             1          40             2  1  \n",
       "3997            19          -1             0  0  \n",
       "3998             1          -1             0  0  \n",
       "3999             1         227             3  0  \n",
       "\n",
       "[2961 rows x 10 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Vamos a tantear una correlacion entre las variables numericas y nuestro target\n",
    "# para ello vamos a juntarlas en un dataset y graficar las correlaciones\n",
    "\n",
    "X[\"y\"] = y\n",
    "X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "c07c3e9b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>Default</th>\n",
       "      <th>Balance</th>\n",
       "      <th>HHInsurance</th>\n",
       "      <th>CarLoan</th>\n",
       "      <th>LastContactDay</th>\n",
       "      <th>NoOfContacts</th>\n",
       "      <th>DaysPassed</th>\n",
       "      <th>PrevAttempts</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Age</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.012718</td>\n",
       "      <td>0.089050</td>\n",
       "      <td>-0.181506</td>\n",
       "      <td>-0.015540</td>\n",
       "      <td>0.029469</td>\n",
       "      <td>0.034449</td>\n",
       "      <td>-0.022953</td>\n",
       "      <td>-0.011514</td>\n",
       "      <td>0.038948</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Default</th>\n",
       "      <td>0.012718</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.049506</td>\n",
       "      <td>-0.015844</td>\n",
       "      <td>0.142996</td>\n",
       "      <td>0.057144</td>\n",
       "      <td>0.044541</td>\n",
       "      <td>-0.031639</td>\n",
       "      <td>-0.032042</td>\n",
       "      <td>-0.032534</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Balance</th>\n",
       "      <td>0.089050</td>\n",
       "      <td>-0.049506</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.058084</td>\n",
       "      <td>-0.081238</td>\n",
       "      <td>0.008980</td>\n",
       "      <td>-0.006830</td>\n",
       "      <td>-0.011615</td>\n",
       "      <td>-0.008109</td>\n",
       "      <td>0.026322</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>HHInsurance</th>\n",
       "      <td>-0.181506</td>\n",
       "      <td>-0.015844</td>\n",
       "      <td>-0.058084</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.089337</td>\n",
       "      <td>-0.055189</td>\n",
       "      <td>-0.008672</td>\n",
       "      <td>0.164888</td>\n",
       "      <td>0.081796</td>\n",
       "      <td>-0.187274</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CarLoan</th>\n",
       "      <td>-0.015540</td>\n",
       "      <td>0.142996</td>\n",
       "      <td>-0.081238</td>\n",
       "      <td>0.089337</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.019142</td>\n",
       "      <td>0.049568</td>\n",
       "      <td>-0.047009</td>\n",
       "      <td>-0.017412</td>\n",
       "      <td>-0.104224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LastContactDay</th>\n",
       "      <td>0.029469</td>\n",
       "      <td>0.057144</td>\n",
       "      <td>0.008980</td>\n",
       "      <td>-0.055189</td>\n",
       "      <td>0.019142</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.182556</td>\n",
       "      <td>-0.094940</td>\n",
       "      <td>-0.089831</td>\n",
       "      <td>-0.090528</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>NoOfContacts</th>\n",
       "      <td>0.034449</td>\n",
       "      <td>0.044541</td>\n",
       "      <td>-0.006830</td>\n",
       "      <td>-0.008672</td>\n",
       "      <td>0.049568</td>\n",
       "      <td>0.182556</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.112346</td>\n",
       "      <td>-0.065063</td>\n",
       "      <td>-0.126071</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>DaysPassed</th>\n",
       "      <td>-0.022953</td>\n",
       "      <td>-0.031639</td>\n",
       "      <td>-0.011615</td>\n",
       "      <td>0.164888</td>\n",
       "      <td>-0.047009</td>\n",
       "      <td>-0.094940</td>\n",
       "      <td>-0.112346</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.467799</td>\n",
       "      <td>0.094035</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>PrevAttempts</th>\n",
       "      <td>-0.011514</td>\n",
       "      <td>-0.032042</td>\n",
       "      <td>-0.008109</td>\n",
       "      <td>0.081796</td>\n",
       "      <td>-0.017412</td>\n",
       "      <td>-0.089831</td>\n",
       "      <td>-0.065063</td>\n",
       "      <td>0.467799</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.121805</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>y</th>\n",
       "      <td>0.038948</td>\n",
       "      <td>-0.032534</td>\n",
       "      <td>0.026322</td>\n",
       "      <td>-0.187274</td>\n",
       "      <td>-0.104224</td>\n",
       "      <td>-0.090528</td>\n",
       "      <td>-0.126071</td>\n",
       "      <td>0.094035</td>\n",
       "      <td>0.121805</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Age   Default   Balance  HHInsurance   CarLoan  \\\n",
       "Age             1.000000  0.012718  0.089050    -0.181506 -0.015540   \n",
       "Default         0.012718  1.000000 -0.049506    -0.015844  0.142996   \n",
       "Balance         0.089050 -0.049506  1.000000    -0.058084 -0.081238   \n",
       "HHInsurance    -0.181506 -0.015844 -0.058084     1.000000  0.089337   \n",
       "CarLoan        -0.015540  0.142996 -0.081238     0.089337  1.000000   \n",
       "LastContactDay  0.029469  0.057144  0.008980    -0.055189  0.019142   \n",
       "NoOfContacts    0.034449  0.044541 -0.006830    -0.008672  0.049568   \n",
       "DaysPassed     -0.022953 -0.031639 -0.011615     0.164888 -0.047009   \n",
       "PrevAttempts   -0.011514 -0.032042 -0.008109     0.081796 -0.017412   \n",
       "y               0.038948 -0.032534  0.026322    -0.187274 -0.104224   \n",
       "\n",
       "                LastContactDay  NoOfContacts  DaysPassed  PrevAttempts  \\\n",
       "Age                   0.029469      0.034449   -0.022953     -0.011514   \n",
       "Default               0.057144      0.044541   -0.031639     -0.032042   \n",
       "Balance               0.008980     -0.006830   -0.011615     -0.008109   \n",
       "HHInsurance          -0.055189     -0.008672    0.164888      0.081796   \n",
       "CarLoan               0.019142      0.049568   -0.047009     -0.017412   \n",
       "LastContactDay        1.000000      0.182556   -0.094940     -0.089831   \n",
       "NoOfContacts          0.182556      1.000000   -0.112346     -0.065063   \n",
       "DaysPassed           -0.094940     -0.112346    1.000000      0.467799   \n",
       "PrevAttempts         -0.089831     -0.065063    0.467799      1.000000   \n",
       "y                    -0.090528     -0.126071    0.094035      0.121805   \n",
       "\n",
       "                       y  \n",
       "Age             0.038948  \n",
       "Default        -0.032534  \n",
       "Balance         0.026322  \n",
       "HHInsurance    -0.187274  \n",
       "CarLoan        -0.104224  \n",
       "LastContactDay -0.090528  \n",
       "NoOfContacts   -0.126071  \n",
       "DaysPassed      0.094035  \n",
       "PrevAttempts    0.121805  \n",
       "y               1.000000  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "corr = X.corr()\n",
    "corr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "2e9ad66a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style  type=\"text/css\" >\n",
       "#T_7c609_row0_col0,#T_7c609_row1_col1,#T_7c609_row2_col2,#T_7c609_row3_col3,#T_7c609_row4_col4,#T_7c609_row5_col5,#T_7c609_row6_col6,#T_7c609_row7_col7,#T_7c609_row8_col8,#T_7c609_row9_col9{\n",
       "            background-color:  #b40426;\n",
       "            color:  #f1f1f1;\n",
       "        }#T_7c609_row0_col1,#T_7c609_row1_col0,#T_7c609_row2_col5,#T_7c609_row5_col2{\n",
       "            background-color:  #dedcdb;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row0_col2,#T_7c609_row2_col0,#T_7c609_row3_col4,#T_7c609_row4_col3{\n",
       "            background-color:  #e8d6cc;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row0_col3,#T_7c609_row3_col0,#T_7c609_row3_col9,#T_7c609_row9_col3{\n",
       "            background-color:  #c3d5f4;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row0_col4,#T_7c609_row0_col8,#T_7c609_row2_col7,#T_7c609_row2_col8,#T_7c609_row3_col6,#T_7c609_row4_col0,#T_7c609_row6_col3,#T_7c609_row7_col2,#T_7c609_row8_col0,#T_7c609_row8_col2{\n",
       "            background-color:  #dbdcde;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row0_col5,#T_7c609_row2_col9,#T_7c609_row5_col0,#T_7c609_row9_col2{\n",
       "            background-color:  #e0dbd8;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row0_col6,#T_7c609_row0_col9,#T_7c609_row6_col0,#T_7c609_row9_col0{\n",
       "            background-color:  #e1dad6;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row0_col7,#T_7c609_row1_col3,#T_7c609_row3_col1,#T_7c609_row4_col8,#T_7c609_row7_col0,#T_7c609_row8_col4{\n",
       "            background-color:  #dadce0;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row1_col2,#T_7c609_row2_col1,#T_7c609_row4_col7,#T_7c609_row7_col4{\n",
       "            background-color:  #d6dce4;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row1_col4,#T_7c609_row4_col1{\n",
       "            background-color:  #edd1c2;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row1_col5,#T_7c609_row5_col1{\n",
       "            background-color:  #e4d9d2;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row1_col6,#T_7c609_row6_col1{\n",
       "            background-color:  #e2dad5;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row1_col7,#T_7c609_row1_col8,#T_7c609_row1_col9,#T_7c609_row7_col1,#T_7c609_row8_col1,#T_7c609_row9_col1{\n",
       "            background-color:  #d8dce2;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row2_col3,#T_7c609_row3_col2,#T_7c609_row3_col5,#T_7c609_row5_col3{\n",
       "            background-color:  #d5dbe5;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row2_col4,#T_7c609_row4_col2{\n",
       "            background-color:  #d2dbe8;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row2_col6,#T_7c609_row6_col2{\n",
       "            background-color:  #dcdddd;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row3_col7,#T_7c609_row7_col3{\n",
       "            background-color:  #efcebd;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row3_col8,#T_7c609_row8_col3{\n",
       "            background-color:  #e7d7ce;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row4_col5,#T_7c609_row5_col4{\n",
       "            background-color:  #dfdbd9;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row4_col6,#T_7c609_row6_col4{\n",
       "            background-color:  #e3d9d3;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row4_col9,#T_7c609_row9_col4{\n",
       "            background-color:  #cedaeb;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row5_col6,#T_7c609_row6_col5{\n",
       "            background-color:  #f1cdba;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row5_col7,#T_7c609_row7_col5{\n",
       "            background-color:  #cfdaea;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row5_col8,#T_7c609_row5_col9,#T_7c609_row8_col5,#T_7c609_row9_col5{\n",
       "            background-color:  #d1dae9;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row6_col7,#T_7c609_row7_col6{\n",
       "            background-color:  #cdd9ec;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row6_col8,#T_7c609_row8_col6{\n",
       "            background-color:  #d4dbe6;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row6_col9,#T_7c609_row9_col6{\n",
       "            background-color:  #cbd8ee;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row7_col8,#T_7c609_row8_col7{\n",
       "            background-color:  #f5a081;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row7_col9,#T_7c609_row9_col7{\n",
       "            background-color:  #e9d5cb;\n",
       "            color:  #000000;\n",
       "        }#T_7c609_row8_col9,#T_7c609_row9_col8{\n",
       "            background-color:  #ebd3c6;\n",
       "            color:  #000000;\n",
       "        }</style><table id=\"T_7c609_\" ><thead>    <tr>        <th class=\"blank level0\" ></th>        <th class=\"col_heading level0 col0\" >Age</th>        <th class=\"col_heading level0 col1\" >Default</th>        <th class=\"col_heading level0 col2\" >Balance</th>        <th class=\"col_heading level0 col3\" >HHInsurance</th>        <th class=\"col_heading level0 col4\" >CarLoan</th>        <th class=\"col_heading level0 col5\" >LastContactDay</th>        <th class=\"col_heading level0 col6\" >NoOfContacts</th>        <th class=\"col_heading level0 col7\" >DaysPassed</th>        <th class=\"col_heading level0 col8\" >PrevAttempts</th>        <th class=\"col_heading level0 col9\" >y</th>    </tr></thead><tbody>\n",
       "                <tr>\n",
       "                        <th id=\"T_7c609_level0_row0\" class=\"row_heading level0 row0\" >Age</th>\n",
       "                        <td id=\"T_7c609_row0_col0\" class=\"data row0 col0\" >1.00</td>\n",
       "                        <td id=\"T_7c609_row0_col1\" class=\"data row0 col1\" >0.01</td>\n",
       "                        <td id=\"T_7c609_row0_col2\" class=\"data row0 col2\" >0.09</td>\n",
       "                        <td id=\"T_7c609_row0_col3\" class=\"data row0 col3\" >-0.18</td>\n",
       "                        <td id=\"T_7c609_row0_col4\" class=\"data row0 col4\" >-0.02</td>\n",
       "                        <td id=\"T_7c609_row0_col5\" class=\"data row0 col5\" >0.03</td>\n",
       "                        <td id=\"T_7c609_row0_col6\" class=\"data row0 col6\" >0.03</td>\n",
       "                        <td id=\"T_7c609_row0_col7\" class=\"data row0 col7\" >-0.02</td>\n",
       "                        <td id=\"T_7c609_row0_col8\" class=\"data row0 col8\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row0_col9\" class=\"data row0 col9\" >0.04</td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                        <th id=\"T_7c609_level0_row1\" class=\"row_heading level0 row1\" >Default</th>\n",
       "                        <td id=\"T_7c609_row1_col0\" class=\"data row1 col0\" >0.01</td>\n",
       "                        <td id=\"T_7c609_row1_col1\" class=\"data row1 col1\" >1.00</td>\n",
       "                        <td id=\"T_7c609_row1_col2\" class=\"data row1 col2\" >-0.05</td>\n",
       "                        <td id=\"T_7c609_row1_col3\" class=\"data row1 col3\" >-0.02</td>\n",
       "                        <td id=\"T_7c609_row1_col4\" class=\"data row1 col4\" >0.14</td>\n",
       "                        <td id=\"T_7c609_row1_col5\" class=\"data row1 col5\" >0.06</td>\n",
       "                        <td id=\"T_7c609_row1_col6\" class=\"data row1 col6\" >0.04</td>\n",
       "                        <td id=\"T_7c609_row1_col7\" class=\"data row1 col7\" >-0.03</td>\n",
       "                        <td id=\"T_7c609_row1_col8\" class=\"data row1 col8\" >-0.03</td>\n",
       "                        <td id=\"T_7c609_row1_col9\" class=\"data row1 col9\" >-0.03</td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                        <th id=\"T_7c609_level0_row2\" class=\"row_heading level0 row2\" >Balance</th>\n",
       "                        <td id=\"T_7c609_row2_col0\" class=\"data row2 col0\" >0.09</td>\n",
       "                        <td id=\"T_7c609_row2_col1\" class=\"data row2 col1\" >-0.05</td>\n",
       "                        <td id=\"T_7c609_row2_col2\" class=\"data row2 col2\" >1.00</td>\n",
       "                        <td id=\"T_7c609_row2_col3\" class=\"data row2 col3\" >-0.06</td>\n",
       "                        <td id=\"T_7c609_row2_col4\" class=\"data row2 col4\" >-0.08</td>\n",
       "                        <td id=\"T_7c609_row2_col5\" class=\"data row2 col5\" >0.01</td>\n",
       "                        <td id=\"T_7c609_row2_col6\" class=\"data row2 col6\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row2_col7\" class=\"data row2 col7\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row2_col8\" class=\"data row2 col8\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row2_col9\" class=\"data row2 col9\" >0.03</td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                        <th id=\"T_7c609_level0_row3\" class=\"row_heading level0 row3\" >HHInsurance</th>\n",
       "                        <td id=\"T_7c609_row3_col0\" class=\"data row3 col0\" >-0.18</td>\n",
       "                        <td id=\"T_7c609_row3_col1\" class=\"data row3 col1\" >-0.02</td>\n",
       "                        <td id=\"T_7c609_row3_col2\" class=\"data row3 col2\" >-0.06</td>\n",
       "                        <td id=\"T_7c609_row3_col3\" class=\"data row3 col3\" >1.00</td>\n",
       "                        <td id=\"T_7c609_row3_col4\" class=\"data row3 col4\" >0.09</td>\n",
       "                        <td id=\"T_7c609_row3_col5\" class=\"data row3 col5\" >-0.06</td>\n",
       "                        <td id=\"T_7c609_row3_col6\" class=\"data row3 col6\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row3_col7\" class=\"data row3 col7\" >0.16</td>\n",
       "                        <td id=\"T_7c609_row3_col8\" class=\"data row3 col8\" >0.08</td>\n",
       "                        <td id=\"T_7c609_row3_col9\" class=\"data row3 col9\" >-0.19</td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                        <th id=\"T_7c609_level0_row4\" class=\"row_heading level0 row4\" >CarLoan</th>\n",
       "                        <td id=\"T_7c609_row4_col0\" class=\"data row4 col0\" >-0.02</td>\n",
       "                        <td id=\"T_7c609_row4_col1\" class=\"data row4 col1\" >0.14</td>\n",
       "                        <td id=\"T_7c609_row4_col2\" class=\"data row4 col2\" >-0.08</td>\n",
       "                        <td id=\"T_7c609_row4_col3\" class=\"data row4 col3\" >0.09</td>\n",
       "                        <td id=\"T_7c609_row4_col4\" class=\"data row4 col4\" >1.00</td>\n",
       "                        <td id=\"T_7c609_row4_col5\" class=\"data row4 col5\" >0.02</td>\n",
       "                        <td id=\"T_7c609_row4_col6\" class=\"data row4 col6\" >0.05</td>\n",
       "                        <td id=\"T_7c609_row4_col7\" class=\"data row4 col7\" >-0.05</td>\n",
       "                        <td id=\"T_7c609_row4_col8\" class=\"data row4 col8\" >-0.02</td>\n",
       "                        <td id=\"T_7c609_row4_col9\" class=\"data row4 col9\" >-0.10</td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                        <th id=\"T_7c609_level0_row5\" class=\"row_heading level0 row5\" >LastContactDay</th>\n",
       "                        <td id=\"T_7c609_row5_col0\" class=\"data row5 col0\" >0.03</td>\n",
       "                        <td id=\"T_7c609_row5_col1\" class=\"data row5 col1\" >0.06</td>\n",
       "                        <td id=\"T_7c609_row5_col2\" class=\"data row5 col2\" >0.01</td>\n",
       "                        <td id=\"T_7c609_row5_col3\" class=\"data row5 col3\" >-0.06</td>\n",
       "                        <td id=\"T_7c609_row5_col4\" class=\"data row5 col4\" >0.02</td>\n",
       "                        <td id=\"T_7c609_row5_col5\" class=\"data row5 col5\" >1.00</td>\n",
       "                        <td id=\"T_7c609_row5_col6\" class=\"data row5 col6\" >0.18</td>\n",
       "                        <td id=\"T_7c609_row5_col7\" class=\"data row5 col7\" >-0.09</td>\n",
       "                        <td id=\"T_7c609_row5_col8\" class=\"data row5 col8\" >-0.09</td>\n",
       "                        <td id=\"T_7c609_row5_col9\" class=\"data row5 col9\" >-0.09</td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                        <th id=\"T_7c609_level0_row6\" class=\"row_heading level0 row6\" >NoOfContacts</th>\n",
       "                        <td id=\"T_7c609_row6_col0\" class=\"data row6 col0\" >0.03</td>\n",
       "                        <td id=\"T_7c609_row6_col1\" class=\"data row6 col1\" >0.04</td>\n",
       "                        <td id=\"T_7c609_row6_col2\" class=\"data row6 col2\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row6_col3\" class=\"data row6 col3\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row6_col4\" class=\"data row6 col4\" >0.05</td>\n",
       "                        <td id=\"T_7c609_row6_col5\" class=\"data row6 col5\" >0.18</td>\n",
       "                        <td id=\"T_7c609_row6_col6\" class=\"data row6 col6\" >1.00</td>\n",
       "                        <td id=\"T_7c609_row6_col7\" class=\"data row6 col7\" >-0.11</td>\n",
       "                        <td id=\"T_7c609_row6_col8\" class=\"data row6 col8\" >-0.07</td>\n",
       "                        <td id=\"T_7c609_row6_col9\" class=\"data row6 col9\" >-0.13</td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                        <th id=\"T_7c609_level0_row7\" class=\"row_heading level0 row7\" >DaysPassed</th>\n",
       "                        <td id=\"T_7c609_row7_col0\" class=\"data row7 col0\" >-0.02</td>\n",
       "                        <td id=\"T_7c609_row7_col1\" class=\"data row7 col1\" >-0.03</td>\n",
       "                        <td id=\"T_7c609_row7_col2\" class=\"data row7 col2\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row7_col3\" class=\"data row7 col3\" >0.16</td>\n",
       "                        <td id=\"T_7c609_row7_col4\" class=\"data row7 col4\" >-0.05</td>\n",
       "                        <td id=\"T_7c609_row7_col5\" class=\"data row7 col5\" >-0.09</td>\n",
       "                        <td id=\"T_7c609_row7_col6\" class=\"data row7 col6\" >-0.11</td>\n",
       "                        <td id=\"T_7c609_row7_col7\" class=\"data row7 col7\" >1.00</td>\n",
       "                        <td id=\"T_7c609_row7_col8\" class=\"data row7 col8\" >0.47</td>\n",
       "                        <td id=\"T_7c609_row7_col9\" class=\"data row7 col9\" >0.09</td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                        <th id=\"T_7c609_level0_row8\" class=\"row_heading level0 row8\" >PrevAttempts</th>\n",
       "                        <td id=\"T_7c609_row8_col0\" class=\"data row8 col0\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row8_col1\" class=\"data row8 col1\" >-0.03</td>\n",
       "                        <td id=\"T_7c609_row8_col2\" class=\"data row8 col2\" >-0.01</td>\n",
       "                        <td id=\"T_7c609_row8_col3\" class=\"data row8 col3\" >0.08</td>\n",
       "                        <td id=\"T_7c609_row8_col4\" class=\"data row8 col4\" >-0.02</td>\n",
       "                        <td id=\"T_7c609_row8_col5\" class=\"data row8 col5\" >-0.09</td>\n",
       "                        <td id=\"T_7c609_row8_col6\" class=\"data row8 col6\" >-0.07</td>\n",
       "                        <td id=\"T_7c609_row8_col7\" class=\"data row8 col7\" >0.47</td>\n",
       "                        <td id=\"T_7c609_row8_col8\" class=\"data row8 col8\" >1.00</td>\n",
       "                        <td id=\"T_7c609_row8_col9\" class=\"data row8 col9\" >0.12</td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                        <th id=\"T_7c609_level0_row9\" class=\"row_heading level0 row9\" >y</th>\n",
       "                        <td id=\"T_7c609_row9_col0\" class=\"data row9 col0\" >0.04</td>\n",
       "                        <td id=\"T_7c609_row9_col1\" class=\"data row9 col1\" >-0.03</td>\n",
       "                        <td id=\"T_7c609_row9_col2\" class=\"data row9 col2\" >0.03</td>\n",
       "                        <td id=\"T_7c609_row9_col3\" class=\"data row9 col3\" >-0.19</td>\n",
       "                        <td id=\"T_7c609_row9_col4\" class=\"data row9 col4\" >-0.10</td>\n",
       "                        <td id=\"T_7c609_row9_col5\" class=\"data row9 col5\" >-0.09</td>\n",
       "                        <td id=\"T_7c609_row9_col6\" class=\"data row9 col6\" >-0.13</td>\n",
       "                        <td id=\"T_7c609_row9_col7\" class=\"data row9 col7\" >0.09</td>\n",
       "                        <td id=\"T_7c609_row9_col8\" class=\"data row9 col8\" >0.12</td>\n",
       "                        <td id=\"T_7c609_row9_col9\" class=\"data row9 col9\" >1.00</td>\n",
       "            </tr>\n",
       "    </tbody></table>"
      ],
      "text/plain": [
       "<pandas.io.formats.style.Styler at 0x7f959dc62eb0>"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "corr.style.background_gradient(cmap=\"coolwarm\", vmin=-1, vmax=1).set_precision(2)\n",
    "# vaya basura"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4bddeacb",
   "metadata": {},
   "source": [
    "Vamos a intentar sacar algo de las variables string del modelo"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "0bdcc219",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import OneHotEncoder"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "eb3c1155",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-24-67a8d2b27842>:9: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().\n",
      "  rf.fit(encoder.fit_transform(X_train), y_train)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0.517123287671233"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# EXPERIMENTO: AÑADIMOS ONEHOTENCODER DE TODAS LAS VAR STRING A TODO EL DATASET\n",
    "\n",
    "X = car_train[car_train.columns[:-1]].select_dtypes(\"number\")\n",
    "y = car_train[car_train.columns[-1:]]\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)\n",
    "\n",
    "\n",
    "encoder = OneHotEncoder(handle_unknown=\"ignore\")\n",
    "\n",
    "rf = RandomForestClassifier()\n",
    "rf.fit(encoder.fit_transform(X_train), y_train)\n",
    "preds = rf.predict(encoder.transform(X_test))\n",
    "f1_score(y_test, preds)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e29956de",
   "metadata": {},
   "source": [
    "Vemos que al meter el encoder incluso perdemos predictabilidad"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "b2bb1cea",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-25-01a4b727fe21>:11: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().\n",
      "  rf.fit(encoder.fit_transform(X_train), y_train)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0.570915619389587"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# EXPERIMENTO: NUEVA PARTICION DE DATOS + get_dummies\n",
    "\n",
    "numeric = car_train[car_train.columns[:-1]].select_dtypes(\"number\")\n",
    "other = pd.get_dummies(car_train[car_train.columns[:-1]].select_dtypes(\"object\"))\n",
    "\n",
    "X = pd.concat([numeric, other], axis=1)\n",
    "y = car_train[car_train.columns[-1:]]\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)\n",
    "rf = RandomForestClassifier()\n",
    "rf.fit(encoder.fit_transform(X_train), y_train)\n",
    "preds = rf.predict(encoder.transform(X_test))\n",
    "f1_score(y_test, preds)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "922fb1f0",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
